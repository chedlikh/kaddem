pipeline {
    agent { label 'slave02' }
    tools {
        maven "M2_HOME"
    }

    environment {
        EMAIL_RECIPIENT = 'chdouuulaa@gmail.com'
        EMAIL_SUBJECT = 'Jenkins Build Notification Test'
    }

    stages {
        stage('Checkout') {
            steps {
                // Récupération du code depuis le référentiel Git
                git url: 'https://github.com/chedlikh/kaddem.git', branch: 'chedli'
            }
        }

        stage('Build') {
            steps {
                sh 'mvn clean package' // For a Maven project
            }
        }

        stage("Email Notification Test") {
            steps {
                script {
                    // Test sending an email notification
                    emailext(
                        subject: "${EMAIL_SUBJECT}",
                        body: "This is a test email from Jenkins to verify email notification settings.",
                        to: "${EMAIL_RECIPIENT}"
                    )
                }
            }
        }
    }
}
